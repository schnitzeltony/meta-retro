From 168f7f181099e6fbbb4ba7100e45f224afec6107 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@googlemail.com>
Date: Sat, 26 Dec 2015 21:29:16 +0100
Subject: [PATCH] use pkg-config for finding sdl library settings
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@googlemail.com>
---
 scripts/src/osd/sdl.lua     | 6 +++---
 scripts/src/osd/sdl_cfg.lua | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/scripts/src/osd/sdl.lua b/scripts/src/osd/sdl.lua
index 76947ad..9b6b54d 100644
--- a/scripts/src/osd/sdl.lua
+++ b/scripts/src/osd/sdl.lua
@@ -68,7 +68,7 @@ function maintargetosdoptions(_target,_subtarget)
 				}
 			configuration { }
 		else
-			local str = backtick(sdlconfigcmd() .. " --libs | sed 's/ -lSDLmain//'")
+			local str = backtick("pkg-config --libs sdl2 | sed 's/-lSDLmain//'")
 			addlibfromstring(str)
 			addoptionsfromstring(str)
 		end
@@ -256,7 +256,7 @@ if BASE_TARGETOS=="unix" then
 				"SDL2.framework",
 			}
 		else
-			local str = backtick(sdlconfigcmd() .. " --libs --static | sed 's/-lSDLmain//'")
+			local str = backtick("pkg-config --libs --static sdl2 | sed 's/-lSDLmain//'")
 			addlibfromstring(str)
 			addoptionsfromstring(str)
 		end
@@ -270,7 +270,7 @@ if BASE_TARGETOS=="unix" then
 				"/usr/openwin/lib",
 			}
 		end
-		local str = backtick(sdlconfigcmd() .. " --libs")
+		local str = backtick("pkg-config --libs sdl2")
 		addlibfromstring(str)
 		addoptionsfromstring(str)
 		if _OPTIONS["targetos"]~="haiku" then
diff --git a/scripts/src/osd/sdl_cfg.lua b/scripts/src/osd/sdl_cfg.lua
index e3a6f91..f88394e 100644
--- a/scripts/src/osd/sdl_cfg.lua
+++ b/scripts/src/osd/sdl_cfg.lua
@@ -84,12 +84,12 @@ if BASE_TARGETOS=="unix" then
 				"MACOSX_USE_LIBSDL",
 			}
 			buildoptions {
-				backtick(sdlconfigcmd() .. " --cflags | sed 's:/SDL::'"),
+				backtick("pkg-config --cflags sdl2 | sed 's:/SDL::'"),
 			}
 		end
 	else
 		buildoptions {
-			backtick(sdlconfigcmd() .. " --cflags"),
+			backtick("pkg-config --cflags sdl2"),
 		}
 		if _OPTIONS["targetos"]~="asmjs" then
 			buildoptions {
@@ -142,7 +142,7 @@ elseif _OPTIONS["targetos"]=="os2" then
 		"SDLMAME_OS2",
 	}
 	buildoptions {
-		backtick(sdlconfigcmd() .. " --cflags"),
+		backtick("pkg-config --cflags sdl2"),
 	}
 end
 
-- 
2.5.0

