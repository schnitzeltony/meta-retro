From 35d0c1b43eeff5a8e7a0e24b9dec8f170957ee0b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andreas=20M=C3=BCller?= <schnitzeltony@gmail.com>
Date: Thu, 7 Mar 2019 20:11:01 +0100
Subject: [PATCH 1/3] pokey: force recalculation of raw sound output after
 reset
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

* This fixes a regression introduced by [1]
* Could not detect and performance change introduced by this

Upstream-Status: Applied

[1] https://github.com/mamedev/mame/pull/4702/commits/308c3c2d04ce8f3af09f620f524579145cbbcaf0

Signed-off-by: Andreas MÃ¼ller <schnitzeltony@gmail.com>
---
 src/devices/sound/pokey.cpp | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/devices/sound/pokey.cpp b/src/devices/sound/pokey.cpp
index 5aa797bb54..a79c8abb71 100644
--- a/src/devices/sound/pokey.cpp
+++ b/src/devices/sound/pokey.cpp
@@ -1031,6 +1031,7 @@ void pokey_device::write_internal(offs_t offset, uint8_t data)
 			m_clock_cnt[0] = 0;
 			m_clock_cnt[1] = 0;
 			m_clock_cnt[2] = 0;
+			m_old_raw_inval = true;
 			/* FIXME: Serial port reset ! */
 		}
 		break;
-- 
2.20.1

